# ğŸš€ Agent-Driven NCNN Cross-Architecture Migration Benchmark
# æ™ºèƒ½ä½“é©±åŠ¨çš„ NCNN åº“è·¨æ¶æ„ä»£ç è¿ç§» Benchmark

[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](./LICENSE)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](CONTRIBUTING.md)
[![RISC-V](https://img.shields.io/badge/Platform-RISC--V-red)](https://riscv.org/)
[![NCNN](https://img.shields.io/badge/Framework-NCNN-yellow)](https://github.com/Tencent/ncnn)


> our **English Version**: [README_EN.md](./README_EN.md)
---

## ğŸ“– ç›®å½• (Table of Contents)

- [é¡¹ç›®ä»‹ç» (Introduction)](#-é¡¹ç›®ä»‹ç»-introduction)
- [ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ª Benchmarkï¼Ÿ(Background)](#-ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ª-benchmark-background)
- [è¿ç§»éš¾ç‚¹ (Key Challenges)](#-è¿ç§»éš¾ç‚¹-key-challenges)
- [ä¸å…¶ä»– Benchmark çš„å·®å¼‚ (Comparison)](#-ä¸å…¶ä»–-benchmark-çš„å·®å¼‚-comparison)
- [æµ‹è¯•é›†è®¾è®¡ä¸éš¾åº¦åˆ†çº§ (Dataset & Hierarchy)](#-æµ‹è¯•é›†è®¾è®¡ä¸éš¾åº¦åˆ†çº§-dataset--hierarchy)
- [æµ‹è¯•é¢˜ç›® (Test Cases)](#-æµ‹è¯•é¢˜ç›®-test-cases)
- [åŸºå‡†æµ‹è¯•ç»“æœ (SoTA Results)](#-åŸºå‡†æµ‹è¯•ç»“æœ-sota-results)
- [ä½¿ç”¨æ–¹æ³• (Getting Started)](#-ä½¿ç”¨æ–¹æ³•-getting-started)
- [å¼•ç”¨ (Citation)](#-å¼•ç”¨-citation)

---

## ğŸ“ é¡¹ç›®ä»‹ç» (Introduction)

ä¸ºäº†ä¿ƒè¿› RISC-V åŸºç¡€è½¯ä»¶ç”Ÿæ€ç¹è£ï¼ŒåŒæ—¶æ¨åŠ¨å­¦æœ¯ç•Œå’Œäº§ä¸šç•Œåˆ©ç”¨æ™ºèƒ½ä½“ï¼ˆAI Agentsï¼‰è¿›è¡Œè·¨æ¶æ„ä»£ç è¿ç§»çš„æ¢ç´¢ï¼Œæˆ‘ä»¬åŸºäºç«¯ä¾§æ€§èƒ½æè‡´ä¼˜åŒ–çš„ **NCNN æ¨ç†æ¡†æ¶**ï¼Œæ„å»ºäº†ä¸šç•Œé¦–ä¸ª**æ™ºèƒ½ä½“é©±åŠ¨çš„ NCNN åº“è·¨æ¶æ„è¿ç§» Benchmark**ã€‚

è™½ç„¶ç›®å‰å·²ç»æœ‰ä¸€äº›é¡¹ç›®çº§ä»£ç  Benchmark å‘å¸ƒï¼Œä½†æ˜¯è¿™äº› Benchmark å¹¶ä¸é€‚ç”¨äºè·¨ä¸åŒç¡¬ä»¶æ¶æ„ï¼ˆç‰¹åˆ«æ˜¯é’ˆå¯¹ SIMD æŒ‡ä»¤é›†ï¼‰çš„ä»£ç è¿ç§»ä»»åŠ¡ã€‚æœ¬é¡¹ç›®çš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªæ ‡å‡†åŒ–çš„æµ‹è¯•å¹³å°ï¼Œè¯„ä¼°å¤§æ¨¡å‹æ™ºèƒ½ä½“å°†ç°æœ‰æˆç†Ÿæ¶æ„ï¼ˆx86/ARM/MIPS/LoongArchï¼‰çš„å‘é‡åŒ–å®ç°è‡ªåŠ¨è¿ç§»åˆ° RISC-V Vector (RVV) æ¶æ„çš„èƒ½åŠ›ï¼Œå¹¶é‡ç‚¹å…³æ³¨ä»£ç çš„æ­£ç¡®æ€§ä¸æ€§èƒ½ä¼˜åŒ–ã€‚

---

## ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ª Benchmarkï¼Ÿ

### ç°çŠ¶ä¸ç—›ç‚¹
ç°æœ‰æ·±åº¦å­¦ä¹ æ¨ç†æ¡†æ¶å¤§å¤šæ•°å¹¶ä¸åŸç”Ÿæ”¯æŒ RISC-V å‘é‡æ‰©å±•åç«¯ã€‚è™½ç„¶ä»…æœ‰å°‘æ•°æ¡†æ¶æ‰‹åŠ¨æ”¯æŒäº†éƒ¨åˆ†ç®—å­çš„ RVV åç«¯ï¼Œä½†å¾€å¾€å­˜åœ¨ç›¸æ¯”æ ‡é‡å®ç°**æ€§èƒ½è´Ÿä¼˜åŒ–**çš„ç®—å­ï¼Œå¯¼è‡´æ— æ³•å……åˆ†åˆ©ç”¨ RISC-V å¤„ç†å™¨çš„å‘é‡æ‰©å±•æ¨¡å—æ¥åŠ é€Ÿæ¨¡å‹æ¨ç†ã€‚

å¯¹è¿™äº›æ·±åº¦å­¦ä¹ æ¡†æ¶é€ä¸ªæ‰‹åŠ¨æ”¯æŒ RISC-V å‘é‡åŒ–éœ€è¦è€—è´¹å¤§é‡çš„äººåŠ›å’Œæ—¶é—´æˆæœ¬ã€‚å› æ­¤ï¼Œ**äºŸéœ€å®ç°è¿™äº›æ·±åº¦å­¦ä¹ æ¨ç†æ¡†æ¶çš„è‡ªåŠ¨åŒ–å‘é‡åŒ–æ”¯æŒï¼Œå¹¶åˆ‡å®æå‡æ¨¡å‹æ¨ç†é€Ÿåº¦ã€‚**

### è‡ªåŠ¨åŒ–è¿ç§»çš„ä»·å€¼
è‡ªåŠ¨åŒ–ä»£ç è¿ç§»åœ¨ç³»ç»Ÿç»´æŠ¤æ–¹é¢è‡³å…³é‡è¦ã€‚ç”±äºç³»ç»Ÿåœ¨å…¶ç”Ÿå‘½å‘¨æœŸä¸­é€šå¸¸ä¼šç»å†å¤šæ¬¡è¿ç§»ï¼Œè‡ªåŠ¨åŒ–å¯ä»¥é¿å…é‡å¤çš„æ‰‹åŠ¨å·¥ä½œã€‚æ·±åº¦å­¦ä¹ æ¨ç†æ¡†æ¶å¯¹ RISC-V çš„å‘é‡åŒ–æ”¯æŒï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä»ç°æœ‰æˆç†Ÿçš„ x86ã€ARM ç­‰æ¶æ„çš„å‘é‡åŒ–å®ç°ï¼Œè·¨æ¶æ„è¿ç§»åˆ° RISC-V çš„è¿‡ç¨‹ã€‚

### å¤§æ¨¡å‹æ™ºèƒ½ä½“çš„æœºé‡
éšç€å¤§æ¨¡å‹å‚æ•°è§„æ¨¡çš„ä¸æ–­æ‰©å¼ ï¼Œå…¶åœ¨ä»£ç é¢†åŸŸçš„æ€§èƒ½å–å¾—äº†æ˜¾è‘—æå‡ã€‚è¿‘å¹´æ¥ï¼Œå¤§æ¨¡å‹æ™ºèƒ½ä½“åœ¨ä»£ç ç”Ÿæˆã€è¡¥å…¨ã€é‡æ„ã€ä¿®å¤ã€æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆä»¥åŠæœ€è¿‘çš„ä»£ç è¿ç§»ç­‰è½¯ä»¶å·¥ç¨‹ä»»åŠ¡ä¸­å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚

åˆ©ç”¨å¤§æ¨¡å‹æ™ºèƒ½ä½“è¿›è¡Œè‡ªåŠ¨ç®—å­æ€§èƒ½ä¼˜åŒ–ï¼Œä¸ä»…èƒ½èŠ‚çœæ‰‹åŠ¨è¿ç§»çš„å¤§é‡æˆæœ¬ï¼Œè¿˜èƒ½æ˜¾è‘—æå‡ç«¯åˆ°ç«¯çš„æ¨¡å‹æ¨ç†é€Ÿåº¦ã€‚



## âš–ï¸ ä¸å…¶ä»–åº“åŠ Benchmark çš„å·®å¼‚ (Comparison)

> *æœ¬ç« èŠ‚æ·±å…¥å‰–ææœ¬ Benchmark ä¸é«˜æ€§èƒ½è§†è§‰åº“ï¼ˆOpenCVï¼‰åŠç°æœ‰ä»£ç ç”Ÿæˆæ•°æ®é›†ï¼ˆå¦‚ SWE-bench, HumanEvalï¼‰çš„æœ¬è´¨åŒºåˆ«ã€‚*

### 1. ä¸ OpenCV çš„æ ¸å¿ƒå·®å¼‚ (vs. OpenCV)

è™½ç„¶ NCNN å’Œ OpenCV åŒä¸ºè®¡ç®—æœºè§†è§‰é¢†åŸŸçš„ C++ åº“ï¼Œä½†ä¸¤è€…çš„**ä¼˜åŒ–å“²å­¦**ä¸**è¿ç§»éš¾åº¦**å­˜åœ¨ç»´åº¦çº§çš„å·®å¼‚ã€‚

#### ğŸš© ä¼˜åŒ–å“²å­¦çš„æ ¹æœ¬åˆ†æ­§ (Optimization Philosophy)

#### ğŸ§© ç®—å­è¯­ä¹‰çš„å¤æ‚åº¦é¸¿æ²Ÿ (Complexity Gap)

#### ğŸ“¦ ç‹¬ç‰¹çš„æ•°æ®å¸ƒå±€é™·é˜± (Layout Pitfalls)

#### ğŸ•¸ï¸ å·¥ç¨‹ä¾èµ–çš„â€œæ·±åº¦é™·é˜±â€ (Dependency Depth)

#### ğŸ§  æ™ºèƒ½ä½“èƒ½åŠ›éœ€æ±‚çŸ©é˜µ (Capability Matrix)


---

### 2. ä¸é€šç”¨ä»£ç  Benchmark çš„å¯¹æ¯” (vs. Related Benchmarks)

æœ¬ Benchmark å¡«è¡¥äº†ç°æœ‰ä»£ç è¯„æµ‹æ•°æ®é›†åœ¨ **è·¨æ¶æ„è¿ç§» (Cross-Architecture)** ä¸ **æè‡´æ€§èƒ½ä¼˜åŒ– (Performance-Critical)** äº¤å‰é¢†åŸŸçš„ç©ºç™½ã€‚

#### ğŸ“Š ç»¼åˆå¯¹æ¯”è¡¨ (Comparison Table)

| Benchmark | ç²’åº¦ (Granularity) | è¯­è¨€ (Language) | å…³æ³¨æ­£ç¡®æ€§ (Correctness) | å…³æ³¨æ€§èƒ½ (Perf) | å…³æ³¨è·¨æ¶æ„ (Cross-Arch) | æ ¸å¿ƒä»»åŠ¡ (Task Focus) |
| :--- | :--- | :--- | :---: | :---: | :---: | :--- |
| **ClassEval** | Class-level | Python | âœ… | âŒ | âŒ | ç±»çº§åˆ«çš„ä»£ç ç”Ÿæˆ |
| **SWE-bench** | Repo-level | Python | âœ… | âŒ | âŒ | è§£å†³çœŸå® GitHub Issue |
| **JavaBench** | Repo-level | Java | âœ… | âŒ | âŒ | ä¸“ä¸š Java å¼€å‘èƒ½åŠ› |
| **KernelBench** | Repo-level | CUDA | âœ… | âœ… | âŒ | é«˜æ€§èƒ½ GPU å†…æ ¸ç”Ÿæˆ |
| **ParEval** | Func-level | CUDA/C++ | âœ… | âœ… | âŒ | å¹¶è¡Œè®¡ç®—ç¨‹åºç”Ÿæˆ |
| **Swe-Perf** | Repo-level | Python | âœ… | âœ… | âŒ | ä»“åº“çº§æ€§èƒ½ç“¶é¢ˆä¿®å¤ |
| **CISC-RISC** | Func-level | Assembly | âœ… | âŒ | âœ… | æ±‡ç¼–ä»£ç è½¬è¯‘ |
| **Agent-NCNN (Ours)** | **Repo-level** | **C++ / Intrinsic** | **âœ…** | **âœ…** | **âœ…** | **è·¨æ¶æ„ç®—å­è¿ç§»ä¸ä¼˜åŒ–** |

#### ğŸš€ æ ¸å¿ƒå·®å¼‚åˆ†æ (Key Differentiators)

1.  **æ¯”é€šç”¨ä»£ç ç”Ÿæˆæ›´â€œç¡¬æ ¸â€**:
    ç›¸æ¯” SWE-bench ç­‰å…³æ³¨é€»è¾‘æ­£ç¡®æ€§çš„ Benchmarkï¼ŒAgent-NCNN å¼•å…¥äº†**â€œæ€§èƒ½çº¦æŸâ€**ï¼Œè¦æ±‚ç”Ÿæˆçš„ RVV ä»£ç åœ¨æ€§èƒ½ä¸Šè¶…è¶Šæ ‡é‡å®ç°ã€‚

2.  **æ¯”é«˜æ€§èƒ½è®¡ç®—åº“æ›´â€œå¤æ‚â€**:
    ç›¸æ¯” KernelBench çš„ç‹¬ç«‹ Kernel ç”Ÿæˆï¼ŒAgent-NCNN å¤„äº **Repo-level**ã€‚è¿ç§»è¿‡ç¨‹æ— æ³•è„±ç¦» `ncnn/layer.h` ç­‰é¡¹ç›®ä¸Šä¸‹æ–‡ï¼Œè¿«ä½¿æ™ºèƒ½ä½“å¤„ç†**è·¨æ–‡ä»¶ä¾èµ–**ä¸**å®å®šä¹‰è¿·é›¾**ã€‚

3.  **æ¯”å•çº¯æ±‡ç¼–è½¬è¯‘æ›´â€œå·¥ç¨‹åŒ–â€**:
    ç›¸æ¯” CISC-RISC çš„æŒ‡ä»¤äº’è¯‘ï¼ŒAgent-NCNN æ˜¯ä» **x86 Intrinsic (C++)** åˆ° **RVV Intrinsic (C++)** çš„è¿ç§»ï¼Œæ¶‰åŠä»**å®šé•¿å‘é‡**åˆ°**å˜é•¿å‘é‡ (VLEN)** çš„ç®—æ³•çº§é‡æ„ã€‚

---

## ğŸ“Š æµ‹è¯•é›†è®¾è®¡ä¸éš¾åº¦åˆ†çº§ (Dataset & Hierarchy)

æœ¬ Benchmark é‡‡ç”¨åˆ†å±‚æµ‹è¯•çš„æ–¹æ³•è®ºï¼Œå¦‚ [å±‚çº§åˆ’åˆ†ä»‹ç»](design/intro_NCNNbenchmark_level.md) æ‰€è¿°ï¼Œä»å¾®è§‚çš„ç®—å­å®ç°åˆ°å®è§‚çš„æ¨¡å‹æ¨ç†ï¼Œæ„å»ºäº† **ç®—å­çº§ (Operator)**ã€**æ¨¡å‹çº§ (Model)** å’Œ **åº“çº§ (Library)** ä¸‰å¤§ç»´åº¦çš„è¯„ä¼°ä½“ç³»ã€‚

### 1. æµ‹è¯•å±‚çº§è®¾è®¡ (Test Levels)

#### ğŸŸ¢ Level 1: ç®—å­çº§æµ‹è¯• (Operator Level)
è¿™æ˜¯ Benchmark çš„åŸºçŸ³ï¼Œå…³æ³¨å•ä¸ªç®—å­ä» x86/ARM åˆ° RISC-V RVV çš„è¿ç§»è´¨é‡ã€‚


#### ğŸŸ¡ Level 2: æ¨¡å‹çº§æµ‹è¯• (Model Level)
å…³æ³¨å¤šä¸ªç®—å­ååŒå·¥ä½œæ—¶çš„ç«¯åˆ°ç«¯è¡¨ç°ã€‚

#### ğŸ”´ Level 3: åº“çº§æµ‹è¯• (Library Level)
* *ğŸš§ æ•¬è¯·æœŸå¾… (Coming Soon)* - æ—¨åœ¨è¯„ä¼°æ•´ä¸ª NCNN åº“åœ¨ RISC-V æ¶æ„ä¸Šçš„ç¼–è¯‘æ„å»ºã€ä¾èµ–ç®¡ç†åŠç³»ç»Ÿçº§å…¼å®¹æ€§ã€‚

---

### 2. éš¾åº¦åˆ†çº§æ ‡å‡† (Difficulty Standards)

ä¸ºäº†ç§‘å­¦è¯„ä¼°æ™ºèƒ½ä½“çš„èƒ½åŠ›è¾¹ç•Œï¼Œæˆ‘ä»¬åœ¨ä¸åŒå±‚çº§è®¾è®¡äº†ç»†ç²’åº¦çš„éš¾åº¦åˆ†çº§ã€‚

#### ğŸ§© ç®—å­çº§éš¾åº¦ (Operator Difficulty)
åŸºäº**è½¯ä»¶é€»è¾‘**ä¸**ç¡¬ä»¶ç‰¹æ€§**çš„åŒé‡ç»´åº¦è¿›è¡Œåˆ†çº§ã€‚
* **ä¾æ®**: ç®—å­çš„ä»£ç è¡Œæ•°ã€æ§åˆ¶æµå¤æ‚åº¦ (Software) ä»¥åŠæŒ‡ä»¤ååã€å‘é‡åŒ–éš¾åº¦ (Hardware)ï¼Œå‚è€ƒæ–‡æ¡£ [ç®—å­éš¾åº¦åˆ’åˆ†ä¾æ®](design/intro_ops_dim.md)ã€‚
* **æ•°æ®**: è¯¦ç»†åˆ†çº§è¯·å‚é˜… [ç®—å­éš¾åº¦åˆ’åˆ†è¡¨](design/operator_difficulty_matrix.csv)ã€‚

---

## ğŸ§ª æµ‹è¯•é¢˜ç›® (Test Cases)

åŸºäºä¸Šè¿°è®¾è®¡ï¼Œæˆ‘ä»¬æä¾›äº†ä¸°å¯Œçš„æµ‹è¯•ç”¨ä¾‹é›†ï¼Œæ¶µç›–ä»åŸºç¡€ç®—å­åˆ°å¤æ‚æ¨¡å‹åœºæ™¯çš„å…¨é¢è¯„ä¼°ã€‚

### 1. ç®—å­çº§é¢˜ç›® (Operator Cases)
æ•°æ®é›†åŒ…å« **16 ä¸ª NCNN æ¨ç†æ¡†æ¶æ ¸å¿ƒç®—å­**ï¼Œæ—¨åœ¨è¦†ç›–æ¨ç†å…³é”®è·¯å¾„å¹¶éªŒè¯ RVV å‘é‡åŒ–åŠ é€Ÿæ•ˆæœï¼Œè¯¦è§ [ç®—å­çº§é¢˜ç›®](data/operators_level/NCNN_operator_README.md)ã€‚

### 2. æ¨¡å‹çº§é¢˜ç›® (Model Cases)
å…±è®¡ **41 ä¸ªæ¨¡å‹**ï¼Œåˆ†ä¸ºä¸¤ä¸ªå±‚çº§è¿›è¡Œç«¯åˆ°ç«¯è¿ç§»è¯„ä¼°ï¼Œè€ƒå¯Ÿ Agent åœ¨ä¸åŒå¤æ‚åº¦ä¸‹çš„ç®—å­å®ç°ä¸æ›¿æ¢èƒ½åŠ›ï¼Œè¯¦è§ [æ¨¡å‹çº§ Level 1 é¢˜ç›®](data/models_level/Level1_README.md) å’Œ [æ¨¡å‹çº§ Level 2 é¢˜ç›®](data/models_level/Level2_README.md)ã€‚

#### Level 1ï¼šåŸºç¡€æ¨¡å‹è¿ç§» (17 ä¸ªæ¨¡å‹)
ä¸»è¦ç”¨äºæµ‹è¯• Agent åœ¨æ— ç®—å­é‡å çš„å®æˆ˜åœºæ™¯ä¸‹çš„åº•å±‚ç®—å­è¿ç§»èƒ½åŠ›ã€‚


#### Level 2ï¼šå¤æ‚åº”ç”¨åœºæ™¯ (24 ä¸ªæ¨¡å‹)
ä¾§é‡äºæµ‹è¯• Agent åœ¨å®Œæ•´æ¨¡å‹åœºæ™¯ä¸‹å¤„ç†å¤šæ ·åŒ–ç®—å­é›†åˆä¸å¤æ‚æ•°æ®æµçš„èƒ½åŠ›ã€‚


### 3. åº“çº§é¢˜ç›® (Lib Cases)
æ•¬è¯·æœŸå¾…ã€‚

> ğŸ“¥ **è·å–å®Œæ•´æµ‹è¯•æ•°æ®**: è¯·è®¿é—® `data/` ç›®å½•è·å–è¯¦ç»† JSON æ ¼å¼çš„æµ‹è¯•ç”¨ä¾‹ã€‚

---

## ğŸ“Š åŸºå‡†æµ‹è¯•ç»“æœ (SoTA Results)

ä¸ºäº†æ·±å…¥åˆ†ææ™ºèƒ½ä½“åœ¨ä¸åŒç±»å‹ç®—å­ä¸Šçš„è¡¨ç°ï¼Œæˆ‘ä»¬æä¾›äº†æ ¸å¿ƒç®—å­çš„é€é¡¹è¯„æµ‹ç»“æœï¼Œè¯¦ç»†æ–‡ä»¶è§ [ç®—å­çº§è¯„æµ‹æ•°æ®](design/sota_llm_result.csv)ã€‚

<details>
<summary>ğŸ”» ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†ç®—å­é€šè¿‡ç‡ (Click to expand)</summary>

| Operator | Joy(DS-V3) | Joy(GPT-4o) | OH(Claude 4.5) | OH(Gemini 3) | Trae(DS-V3) |
|:---|:---:|:---:|:---:|:---:|:---:|
| `concat` | 0% | 0% | **100%** | **100%** | - |
| `relu` | **100%** | - | - | - | - |
| `dropout` | **100%** | - | - | - | - |
| `eltwise` | 0% | 0% | - | - | - |
| `batchnorm` | 20% | - | - | - | - |
| `pooling` | - | - | **100%** | **100%** | 0% |
| `conv_dw` | - | - | - | - | 0% |
| `swish` | 20% | **40%** | - | - | - |
| `sigmoid` | 40% | **60%** | - | - | - |
| `innerproduct`| 0% | 0% | - | - | - |
| `tanh` | 0% | - | - | - | - |
| `conv1d` | 0% | - | - | - | - |
| `softmax` | - | - | 0% | 0% | 12% |
| `lstm` | - | - | 0% | 0% | 0% |
| `gelu` | - | - | - | - | **100%** |
| `convolution` | - | - | 0% | 0% | - |

*(æ³¨: `-` è¡¨ç¤ºè¯¥æ¨¡å‹æœªè¿›è¡Œæ­¤ç®—å­çš„æµ‹è¯•)*

</details>

---

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³• (Getting Started)

```bash
# 1. Clone the repository
git clone [https://github.com/YourOrg/Agent-NCNN-Benchmark.git](https://github.com/YourOrg/Agent-NCNN-Benchmark.git)

# 2. Install dependencies
pip install -r requirements.txt

# 3. Run the benchmark
python run_benchmark.py --target riscv --model gpt-4